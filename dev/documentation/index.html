<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Documentation · SyntheticLikelihood.jl</title><link rel="canonical" href="https://danielward27.github.io/SyntheticLikelihood.jl/documentation/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">SyntheticLikelihood.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/master/docs/src/documentation.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h1><h2 id="Sampling"><a class="docs-heading-anchor" href="#Sampling">Sampling</a><a id="Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.RiemannianULA" href="#SyntheticLikelihood.RiemannianULA"><code>SyntheticLikelihood.RiemannianULA</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Sampler object for Riemannian ULA. Uses the update: θ := θ - ϵ²H⁻¹*∇ - ϵ√H⁻¹ z, where z ∼ N(0, I).</p><ul><li><code>step_size</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/samplers.jl#L110-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.ULA" href="#SyntheticLikelihood.ULA"><code>SyntheticLikelihood.ULA</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Sampler for unadjusted langevin algorithm. Uses a discrete time Euler approximation of the langevin diffusion, given by the update θ := θ - η/2 * ∇ + ξ, where ξ is given by N(0, ηI).</p><ul><li><code>step_size</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/samplers.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.run_sampler!-Tuple{SyntheticLikelihood.AbstractSampler, LocalApproximation}" href="#SyntheticLikelihood.run_sampler!-Tuple{SyntheticLikelihood.AbstractSampler, LocalApproximation}"><code>SyntheticLikelihood.run_sampler!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Run the sampling algorithm. Data to collect at each iteration is specified by <code>collect_data</code>, and should be a subset of <code>[:θ, :objective, :gradient, :hessian, :counter]</code>.</p><pre><code class="language-julia">run_sampler!(sampler, local_approximation; init_θ, n_steps, collect_data)
</code></pre><p>Returns a tuple, with keys matching <code>collect_data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/samplers.jl#L171-L179">source</a></section></article><h4 id="Implementation-details"><a class="docs-heading-anchor" href="#Implementation-details">Implementation details</a><a id="Implementation-details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-details" title="Permalink"></a></h4><p>To implement a new sampler:</p><ul><li>Create a subtype of <code>AbstractSampler</code>, which takes the hyperparameters.</li><li>Create a subtype of <code>AbstractSamplerState</code> which stores the state of the sampler   at each iteration.</li><li>Implement the <code>get_init_state</code> and <code>update!</code> functions to update the state</li></ul><p>(e.g. parameters, gradients, objective function value).</p><h2 id="Objectives"><a class="docs-heading-anchor" href="#Objectives">Objectives</a><a id="Objectives-1"></a><a class="docs-heading-anchor-permalink" href="#Objectives" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.LocalLikelihood" href="#SyntheticLikelihood.LocalLikelihood"><code>SyntheticLikelihood.LocalLikelihood</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Contains the hyperparameters for getting a local approximation of the negative log-likelihood surface using local regressions.</p><ul><li><p><code>simulator</code></p></li><li><p><code>summary</code></p></li><li><p><code>s_true</code></p></li><li><p><code>P</code></p><p>Initial distribution used to peturb the parameter value.</p></li><li><p><code>n_sim</code></p><p>The number of peturbed points to use for the local regression.</p></li><li><p><code>P_regularizer</code></p><p>Method to regularise the inverse Hessian to a reasonable covariance matrix.</p></li><li><p><code>valid_params</code></p><p>Parameter constraints. Function that takes a parameter vector and returns true (for valid parameters) or false (for invalid parameters). Defualt is θ -&gt; true</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_approximation_structs.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.LocalPosterior" href="#SyntheticLikelihood.LocalPosterior"><code>SyntheticLikelihood.LocalPosterior</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Contains the hyperparameters for getting a local approximation of the posterior. In contrast to the likelihood version, a prior is provided, P is by defualt a MvNormal with covariance 0.5*cov(prior), and  valid_params checks whether proposed points fall within the prior support.</p><ul><li><p><code>prior</code></p><p>Prior distribution (either multivariate or Product distribution)</p></li><li><p><code>simulator</code></p></li><li><p><code>summary</code></p></li><li><p><code>s_true</code></p></li><li><p><code>P</code></p></li><li><p><code>n_sim</code></p></li><li><p><code>P_regularizer</code></p></li><li><p><code>valid_params</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_approximation_structs.jl#L28-L35">source</a></section></article><h4 id="Implementation-details-2"><a class="docs-heading-anchor" href="#Implementation-details-2">Implementation details</a><a class="docs-heading-anchor-permalink" href="#Implementation-details-2" title="Permalink"></a></h4><p>To implement a new objective:</p><ul><li>Create a subtype of <code>LocalApproximation</code> defining the hyperpameters.</li><li>Implement <code>obj_grad_hess</code> function to estimate the objective, gradient and   Hessian.</li></ul><h2 id="Matrix-regularisation"><a class="docs-heading-anchor" href="#Matrix-regularisation">Matrix regularisation</a><a id="Matrix-regularisation-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-regularisation" title="Permalink"></a></h2><p>As the Hessian inferred from local regressions is not guarenteed to be positive definite, we may need to modify the Hessian (or its inverse) in some way.</p><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.KitchenSink" href="#SyntheticLikelihood.KitchenSink"><code>SyntheticLikelihood.KitchenSink</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Carries out the following steps:</p><ol><li>Use <code>soft_abs</code> to get absolute values of the eigenvalues.</li><li>If required, shrink the variances towards the reference.</li><li>Decompose the covariance into the variance and correlation.</li><li>Divide the correlation matrix by a constant (if reqiured) to reach condition threshold.</li><li>Set non diagonal correlation to zero if &lt; τ</li><li>Reconstruct the covariance matrix.</li></ol><p>See http://parker.ad.siu.edu/Olive/slch6.pdf for correlation regularization, and https://doi.org/10.1007/978-3-642-40020-9_35 for soft abs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/matrix_regularizers.jl#L6-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.regularize-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}, KitchenSink}" href="#SyntheticLikelihood.regularize-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}, KitchenSink}"><code>SyntheticLikelihood.regularize</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Regularise the covariance matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/matrix_regularizers.jl#L35">source</a></section></article><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><p>Some convenience functions for plotting:</p><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.plot_prior_posterior_density-Tuple{Distributions.Product, AbstractMatrix{T} where T}" href="#SyntheticLikelihood.plot_prior_posterior_density-Tuple{Distributions.Product, AbstractMatrix{T} where T}"><code>SyntheticLikelihood.plot_prior_posterior_density</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Plot the marginal priors and posterior, along with the true parameter values if available.</p><pre><code class="language-julia">plot_prior_posterior_density(prior, θ_samples; param_names)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/plotting.jl#L1-L5">source</a></section></article><h2 id="Private/Unexported-interface"><a class="docs-heading-anchor" href="#Private/Unexported-interface">Private/Unexported interface</a><a id="Private/Unexported-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Private/Unexported-interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.LocalΣ" href="#SyntheticLikelihood.LocalΣ"><code>SyntheticLikelihood.LocalΣ</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct that contains the estimated local properties of Σ (the covariance matrix of the summary statistics).</p><ul><li><p><code>Σ</code></p></li><li><p><code>∂</code></p></li></ul><ul><li>Σ The (nₛ×nₛ) (estimated) covariance matrix of the summary statistics.</li><li>∂ The (nₛ×nₛ×n_θ) matrix of estimated first derivitives of Σ.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/glm_local_regression.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.Localμ" href="#SyntheticLikelihood.Localμ"><code>SyntheticLikelihood.Localμ</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct that contains the estimated local properties of μ (the expected values of the summary statistics).</p><p><strong>Fields</strong></p><ul><li><code>μ::Float64</code> Means of the summary statistics.</li><li><code>∂::Vector{Float64}</code> First derivitives w.r.t. parameters (nₛ×n_θ).</li><li><code>∂²::Matrix{Float64}</code> Second derivitive w.r.t. parameters (nₛ×n<em>θ×n</em>θ).</li><li><code>ϵ::Vector{Float64}</code> Residuals of predicted summary statistics (nₛ×nₛᵢₘ).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/quadratic_local_regression.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.ObjGradHess" href="#SyntheticLikelihood.ObjGradHess"><code>SyntheticLikelihood.ObjGradHess</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct for containing the objective function value, along with the     gradient and hessian if appropriate (defualt to <code>nothing</code>).</p><ul><li><p><code>objective</code></p></li><li><p><code>gradient</code></p></li><li><p><code>hessian</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.ObjectSummaryLogger" href="#SyntheticLikelihood.ObjectSummaryLogger"><code>SyntheticLikelihood.ObjectSummaryLogger</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Used to store and print information about an object. Useful for printing neat debugging messages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L163-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.add_state!-Tuple{NamedTuple, SyntheticLikelihood.AbstractSamplerState, Integer}" href="#SyntheticLikelihood.add_state!-Tuple{NamedTuple, SyntheticLikelihood.AbstractSamplerState, Integer}"><code>SyntheticLikelihood.add_state!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Add data to the data tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/data_collector.jl#L25-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.analytic_mvn_posterior-Tuple{Distributions.AbstractMvNormal, Distributions.AbstractMvNormal}" href="#SyntheticLikelihood.analytic_mvn_posterior-Tuple{Distributions.AbstractMvNormal, Distributions.AbstractMvNormal}"><code>SyntheticLikelihood.analytic_mvn_posterior</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Gets the analytic posterior distribution from a normal prior and normal likelihood. Useful for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L129-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.cor_to_cov-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T}" href="#SyntheticLikelihood.cor_to_cov-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T}"><code>SyntheticLikelihood.cor_to_cov</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Convert correlation matrix to covariance matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L154-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.cov_logdet_reg-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}, Float64}" href="#SyntheticLikelihood.cov_logdet_reg-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}, Float64}"><code>SyntheticLikelihood.cov_logdet_reg</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Scale matrix to a particular log-determinant value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/matrix_regularizers.jl#L133-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.cov_to_cor-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}}" href="#SyntheticLikelihood.cov_to_cor-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}}"><code>SyntheticLikelihood.cov_to_cor</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Convert covariance matrix to correlation matrix. Returns tuple (R, σ²)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L144-L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.deterministic_test_simulator-Tuple{AbstractVector{Float64}}" href="#SyntheticLikelihood.deterministic_test_simulator-Tuple{AbstractVector{Float64}}"><code>SyntheticLikelihood.deterministic_test_simulator</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Deterministic simulator useful for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L121-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.glm_local_Σ-Tuple{}" href="#SyntheticLikelihood.glm_local_Σ-Tuple{}"><code>SyntheticLikelihood.glm_local_Σ</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Use a gamma distributed GLM with log link function to estimate the local properties     of the covariance matrix of the statistics Σ.  θ should not have a bias term (added internally).</p><p>Specifically, this function:</p><ul><li>Creates a rough initial Σ estimate using <code>cov(ϵ)</code>.</li><li>Estimates the diagonal elements Σⱼⱼ, and ∂Σⱼⱼ using local regression.</li><li>Esimates off-diagonal elements of Σ by scaling the sample correlation matrix   with √Σⱼⱼ (standard deviations).</li><li>Esimate off-diagonal gradients ∂Σᵢⱼ by averaging the coefficients associated</li></ul><p>with indices i and j.</p><pre><code class="language-julia">glm_local_Σ(; θᵢ, θ, ϵ)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>θᵢ::AbstractVector</code>  Original θ (used for centering).</li><li><code>θ::AbstractMatrix</code> Peturbed θ from local area.</li><li><code>ϵ::AbstractMatrix</code> Residuals from quadratic regression (n<em>sim × n</em>sumstats).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/glm_local_regression.jl#L22-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.halve_update_until_valid-Tuple{Vector{Float64}, Vector{Float64}, Function}" href="#SyntheticLikelihood.halve_update_until_valid-Tuple{Vector{Float64}, Vector{Float64}, Function}"><code>SyntheticLikelihood.halve_update_until_valid</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Halve update term until valid proposal found (e.g. with non-zero prior density). Returns the modified update term.</p><pre><code class="language-julia">halve_update_until_valid(Δ, θ, valid_params)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>θ</code> Current parameter vector.</li><li><code>Δ</code> Proposed update term.</li><li><code>valid_params</code> Returns true if valid and false if invalid proposal.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/samplers.jl#L201-L210">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.init_data_tuple-Tuple{SyntheticLikelihood.AbstractSamplerState, Vector{Symbol}, Integer}" href="#SyntheticLikelihood.init_data_tuple-Tuple{SyntheticLikelihood.AbstractSamplerState, Vector{Symbol}, Integer}"><code>SyntheticLikelihood.init_data_tuple</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Initialises a named tuple containing Vectors with undefined values. Used with samplers to store results. State just provides an &quot;example&quot; state from which to infer types of vectors in the array. Names of the named tuple are the symbols provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/data_collector.jl#L3-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.likelihood_calc-Tuple{SyntheticLikelihood.Localμ, SyntheticLikelihood.LocalΣ, Vector{Float64}}" href="#SyntheticLikelihood.likelihood_calc-Tuple{SyntheticLikelihood.Localμ, SyntheticLikelihood.LocalΣ, Vector{Float64}}"><code>SyntheticLikelihood.likelihood_calc</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Use results from local regressions to estimate the negative log-likelihood function value, gradient and hessian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L39-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.likelihood_obj_grad_hess-Tuple{LocalApproximation, Vector{Float64}}" href="#SyntheticLikelihood.likelihood_obj_grad_hess-Tuple{LocalApproximation, Vector{Float64}}"><code>SyntheticLikelihood.likelihood_obj_grad_hess</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Negative log-likelihood objective, gradient and hessian estimation using local regressions. Note that this does not ensure positive definiteness of the Hessian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.linear_regression-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T}" href="#SyntheticLikelihood.linear_regression-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T}"><code>SyntheticLikelihood.linear_regression</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Carry out linear regression. X should have a bias column. Returns tuple (β, ŷ).</p><pre><code class="language-julia">linear_regression(X, y)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/quadratic_local_regression.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.log_prior_gradient-Tuple{Distributions.Sampleable, Vector{Float64}}" href="#SyntheticLikelihood.log_prior_gradient-Tuple{Distributions.Sampleable, Vector{Float64}}"><code>SyntheticLikelihood.log_prior_gradient</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Automatic differentiation to get prior gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.log_prior_hessian-Tuple{Distributions.Sampleable, Vector{Float64}}" href="#SyntheticLikelihood.log_prior_hessian-Tuple{Distributions.Sampleable, Vector{Float64}}"><code>SyntheticLikelihood.log_prior_hessian</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Automatic differentiation to get prior Hessian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.obj_grad_hess-Tuple{LocalLikelihood, Any}" href="#SyntheticLikelihood.obj_grad_hess-Tuple{LocalLikelihood, Any}"><code>SyntheticLikelihood.obj_grad_hess</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Estimate negative log-likelihood, and its gradient and hessian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L97-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.obj_grad_hess-Tuple{LocalPosterior, Vector{Float64}}" href="#SyntheticLikelihood.obj_grad_hess-Tuple{LocalPosterior, Vector{Float64}}"><code>SyntheticLikelihood.obj_grad_hess</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Estimate negative log-posterior, and its gradient and hessian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L105-L107">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.outlier_rows-Tuple{AbstractMatrix{T} where T}" href="#SyntheticLikelihood.outlier_rows-Tuple{AbstractMatrix{T} where T}"><code>SyntheticLikelihood.outlier_rows</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Find outlier rows in matrix, using threshold multiples of iqr above and below the median for each column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L185-L188">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.peturb-Tuple{AbstractVector{T} where T, Distributions.Sampleable}" href="#SyntheticLikelihood.peturb-Tuple{AbstractVector{T} where T, Distributions.Sampleable}"><code>SyntheticLikelihood.peturb</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Peturb a vector using a user specified distribution (often MVN zero mean). Returns array of size (n, length(θ)). If  a prior is provided, proposals are checked to have prior support using insupport and are resampled if not.</p><pre><code class="language-julia">peturb(θ, d; n)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>θ</code> Parameter to peturb.</li><li><code>d</code> Distribution from which to sample (see Distributions.jl).</li><li><code>n = 1</code> Number of peturbed vectors to return.</li><li><code>valid_params</code> Return true if θ vector is valid, and false if invalid.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L2-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.posterior_calc-Tuple{Distributions.Sampleable, SyntheticLikelihood.ObjGradHess, Vector{Float64}}" href="#SyntheticLikelihood.posterior_calc-Tuple{Distributions.Sampleable, SyntheticLikelihood.ObjGradHess, Vector{Float64}}"><code>SyntheticLikelihood.posterior_calc</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get the posterior, gradient and Hessian of negative log-posterior, from the prior and the objective, gradient and hessian of the negative log-likelihood.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/local_regression.jl#L81-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.quadratic_design_matrix-Tuple{AbstractMatrix{T} where T}" href="#SyntheticLikelihood.quadratic_design_matrix-Tuple{AbstractMatrix{T} where T}"><code>SyntheticLikelihood.quadratic_design_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Design matrix for quadratic regression. Bias term appended as first column internally. Returns a tuple, with the matrix and the corresponding indices multiplied, that give rise to each column. Note, indices [1, 1] corresponds to the bias term (so indices compared to original matrix is shifted).</p><pre><code class="language-julia">quadratic_design_matrix(X)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/quadratic_local_regression.jl#L19-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.quadratic_local_μ-Tuple{}" href="#SyntheticLikelihood.quadratic_local_μ-Tuple{}"><code>SyntheticLikelihood.quadratic_local_μ</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Finds the local behaviour of the summary statistic mean μ. Uses quadratic linear regression to approximate the mean, gradient and hessian around <code>θᵢ</code>. Returns a <code>Localμ</code> struct (see above).</p><pre><code class="language-julia">quadratic_local_μ(; θᵢ, θ, s)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>θᵢ::AbstractVector</code> Original θ.</li><li><code>θ::AbstractMatrix</code> Peturbed θ (sampled from local area).</li><li><code>s::AbstractMatrix</code> Corresponding summary statistics to θ.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/quadratic_local_regression.jl#L53-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.regularize_cor-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}, Float64, Float64}" href="#SyntheticLikelihood.regularize_cor-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Symmetric}, Float64, Float64}"><code>SyntheticLikelihood.regularize_cor</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Regularize correlation matrix, by limiting the condition number <code>c</code>, and putting all correlations below threshold <code>τ</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/matrix_regularizers.jl#L78-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.regularize_Σ_merge" href="#SyntheticLikelihood.regularize_Σ_merge"><code>SyntheticLikelihood.regularize_Σ_merge</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Regularize the correlation matrix, by shrinking to the reference to make variances fall within thresholds. lo and hi are multiplied by the variances of the reference to find thresholds. Shrinkage is carried out using Σ = αΣ + (1 - α)ref.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/matrix_regularizers.jl#L101-L106">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.remove_invariant-Tuple{Any, Any}" href="#SyntheticLikelihood.remove_invariant-Tuple{Any, Any}"><code>SyntheticLikelihood.remove_invariant</code></a> — <span class="docstring-category">Method</span></header><section><div><p>remove columns that have zero variance</p><pre><code class="language-julia">remove_invariant(s, s_true)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L73-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.rm_outliers-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}" href="#SyntheticLikelihood.rm_outliers-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}"><code>SyntheticLikelihood.rm_outliers</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Remove outlier rows from both matrices, using first matrix to determine outliers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L200-L203">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.rm_outliers-Tuple{AbstractMatrix{T} where T}" href="#SyntheticLikelihood.rm_outliers-Tuple{AbstractMatrix{T} where T}"><code>SyntheticLikelihood.rm_outliers</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Remove outlier rows from matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L209-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.simplify_data-Tuple{NamedTuple}" href="#SyntheticLikelihood.simplify_data-Tuple{NamedTuple}"><code>SyntheticLikelihood.simplify_data</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Loop through named tuple and call stack_arrays on any vector whose elements are an array. Used at end of samplers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/data_collector.jl#L38-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.simulate_n_s-Tuple{AbstractMatrix{T} where T}" href="#SyntheticLikelihood.simulate_n_s-Tuple{AbstractMatrix{T} where T}"><code>SyntheticLikelihood.simulate_n_s</code></a> — <span class="docstring-category">Method</span></header><section><div><p>As for above, but a Matrix of parameter values are used, carrying out one     simulation from each row of θ (and hence <code>n_sim</code> is not required).</p><pre><code class="language-julia">simulate_n_s(θ; simulator, summary, parallel)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/simulate_n_s.jl#L49-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.simulate_n_s-Tuple{AbstractVector{T} where T}" href="#SyntheticLikelihood.simulate_n_s-Tuple{AbstractVector{T} where T}"><code>SyntheticLikelihood.simulate_n_s</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Simulates summary statistics from the model under a fixed parameter vector. <code>n_sim</code> is specified as the number of simulations. Simulations can be run on multiple threads using <code>parallel = false</code>. By defualt no summary statistic function is used (by passing the <code>identity</code> function).</p><pre><code class="language-julia">simulate_n_s(θ; simulator, summary, n_sim, parallel)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>θ::AbstractVector</code> Parameter vector passed to simulator.</li><li><code>simulator::Function</code> Simulator.</li><li><code>summary::Function</code> Summary function that takes output of simulator (defualt identity).</li><li><code>n_sim::Integer</code> Number of simulations.</li><li><code>parallel::Bool = false</code> Whether to run on multiple threads.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/simulate_n_s.jl#L2-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.soft_abs-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Eigen, LinearAlgebra.Symmetric}, Float64}" href="#SyntheticLikelihood.soft_abs-Tuple{Union{LinearAlgebra.Diagonal, LinearAlgebra.Eigen, LinearAlgebra.Symmetric}, Float64}"><code>SyntheticLikelihood.soft_abs</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Takes &quot;soft&quot; absolute value of the eigenvalues, using the method of Betancourt 2013 (https://arxiv.org/pdf/1212.4693.pdf). α → Inf then this approaches the actual absolute value. Minimum eigenvalues are limited to 1/α.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/matrix_regularizers.jl#L60-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.stack_arrays-Tuple{Vector{T} where T}" href="#SyntheticLikelihood.stack_arrays-Tuple{Vector{T} where T}"><code>SyntheticLikelihood.stack_arrays</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Stacks a vector of consitently sized arrays to make a new array with dimensions (length(x), dim(x[1])...).</p><pre><code class="language-julia">stack_arrays(x)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L47-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.standardize-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T}" href="#SyntheticLikelihood.standardize-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T}"><code>SyntheticLikelihood.standardize</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Standardize matrix and vector, using the mean and standard deviation of the matrix.</p><pre><code class="language-julia">standardize(X, y)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L106-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SyntheticLikelihood.standardize-Tuple{AbstractMatrix{T} where T}" href="#SyntheticLikelihood.standardize-Tuple{AbstractMatrix{T} where T}"><code>SyntheticLikelihood.standardize</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Standardize to zero mean and standard deviation 1. Can also provide a vector which will be standardized using the mean and standard deviation of the matrix.</p><pre><code class="language-julia">standardize(X)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danielward27/SyntheticLikelihood.jl/blob/f57e153b8ed6acc1ad7f62d68c0275eef1c1dc1d/src/utils.jl#L94-L98">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 20 April 2021 08:43">Tuesday 20 April 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
